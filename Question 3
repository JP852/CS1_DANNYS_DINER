WITH CTE AS
(  
SELECT M.PRODUCT_NAME
,S.CUSTOMER_ID
,S.ORDER_DATE
,RANK() OVER(PARTITION BY S.CUSTOMER_ID ORDER BY S.ORDER_DATE ASC) AS RANK
FROM SALES AS S
INNER JOIN MENU AS M
ON S.PRODUCT_ID = M.PRODUCT_ID
)
SELECT * 
FROM CTE
WHERE RANK = 1