SELECT 
COUNT(PRODUCT_NAME) AS NUMBER_OF_PRODUCTS
,SUM(PRICE) AS TOTAL_AMOUNT
,SAL.CUSTOMER_ID
FROM SALES AS SAL
INNER JOIN MEMBERS AS MEM
ON SAL.CUSTOMER_ID = MEM.CUSTOMER_ID
INNER JOIN MENU AS MEN
ON SAL.PRODUCT_ID = MEN.PRODUCT_ID
WHERE ORDER_DATE<JOIN_DATE
GROUP BY SAL.CUSTOMER_ID