WITH CTE AS (
  SELECT S.CUSTOMER_ID 
,COUNT(S.ORDER_DATE) AS ORDERS
,M.PRODUCT_NAME
,RANK() OVER(PARTITION BY S.CUSTOMER_ID ORDER BY ORDERS DESC) AS RANK
FROM SALES AS S
INNER JOIN MENU AS M
ON S.PRODUCT_ID = M.PRODUCT_ID
GROUP BY S.CUSTOMER_ID 
,M.PRODUCT_NAME
ORDER BY ORDERS DESC
)
SELECT *
FROM CTE
WHERE RANK = 1